var ShareCardAction;(function(n){function o(i,u){var o=i.getAttribute(e),c=!!i.getAttribute(y),f=n.instances[o],l=sb_gt(),h=function(n){return r(t.ShareButtonClick,f,{promoted:c,success:n,latency:sb_gt()-l})};s(o,function(n){k(n,f,i,u);h(!0)},function(){d(f,i,u);h(!1)})}function p(n){var t=n.getAttribute(e);s(t)}function s(t,i,r){var f=u[t],e,o;f?(i&&(f.success?i(f.cards):f.onsuccess=i),r&&(f.onfailure=r)):(u[t]=f={success:!1,onsuccess:i,onfailure:r,cards:[]},e=function(){u[t]=null;f.onfailure&&f.onfailure()},o=function(n){var t=w(n);if(t){if(f.success=!0,f.cards=t,f.onsuccess)f.onsuccess(t)}else e()},b(n.instances[t],o,e),ShareDialog.bootstrap())}function w(n){var i=sj_ce("div"),r,f,e,u,t,o;return i.innerHTML=n,r=i.querySelector("[data-root='1']"),r&&(f=r.querySelector("[data-json='1']"),e=r.querySelector("[data-html='1']"),f&&e&&(u=JSON.parse(f.innerHTML),u&&u.length>0&&(t=u[0],o=e.children[0].innerHTML,t.title&&t.description&&t.shortTitle&&t.hash&&(t.snapshotUrl&&t.width&&t.height||o))))?(t.html=o,i.removeChild(r),i.children.length>0&&sj_appHTML(sj_b,i.innerHTML),u):void 0}function b(u,f,e){var v=sb_gt(),o=sj_gx(),c=function(){o.onreadystatechange=null;o.ontimeout=null},y="",l,a,p,s;if(u.params){u.params=h(u.params);for(l in u.params)a=u.params[l],a&&(y+="&"+l+"="+i(a))}p="https://"+_w.location.hostname+n.config.apiurl+_w.location.search+y;o.open("POST",p,!0);o.setRequestHeader("Content-type","application/x-www-form-urlencoded");o.onreadystatechange=function(){var n,i;o&&o.readyState==4&&(n=sb_gt()-v,o.status==200?(i=o.responseText,c(),f(i),r(t.FetchCard,u,{success:!0,latency:n})):o.status!=0&&(c(),e(),r(t.FetchCard,u,{success:!1,status:o.status,latency:n})))};o.timeout=6400;o.ontimeout=function(){var n=sb_gt()-v;c();e();r(t.FetchCard,u,{success:!1,timeout:!0,latency:n})};s="answerFilter="+i(u.answertype);s+="&answerService="+i(u.service);s+="&answerScenario="+i(u.scenario);u.segment&&(s+="&answerSegment="+i(u.segment));u.sszoom&&(s+="&sszoom="+i(u.sszoom.toString()));o.send(s)}function h(n){for(var u,f,e,t,o={},i=_w.location.search,s=i&&i.length>0?i.substr(1).split("&"):[],r=0;r<s.length;r++)u=s[r],f=u?u.split("="):[],f.length>0&&(o[f[0]]=1);e={};for(t in n)o[t]||(e[t]=n[t]);return e}function k(n,t,i,r){c(n,t,i,r)}function d(n,t,i){c(null,n,t,i)}function c(t,i,r,u){var c={service:i.service,scenario:i.scenario,sharemethods:i.sharemethods,formcodes:i.formcodes,accessible:u,onclosed:function(){u&&r.focus()}},l={eType:1,html:"<div/>",style:{width:"100%",height:"100%","background-color":"#00809D","background-image":"radial-gradient(circle at 77% 41%, #00C7C7, #00809D)"}},f,o,v,s,e,y,p,w,b;t&&t.length>0?(f=t[0],f.html?(v={eType:1,html:f.html},o=[v]):(s={eType:0,url:f.snapshotUrl,width:f.width,height:f.height,zoomLevel:n.config.cardzoom,style:f.css},f.bgurl?(e=f.bgurl,a.test(e)||(e=_w.location.protocol+"//"+_w.location.hostname+e),y={eType:0,url:e,width:600,height:315},o=[y,s]):o=[l,s]),p={shareElements:o,urlParameters:h(i.shparams),shareHashKey:f.hash,title:f.title,description:f.description,twitter:{text:f.shortTitle},email:{subject:f.emailSubject,body:f.emailBody||""},messaging:{text:f.imText},logParameters:f.log},ShareDialog.show(c,p)):(w={eType:2},b={errorElements:[l,w]},ShareDialog.showError(c,b))}function r(n,i,r){var u=["ShareCard",null,t[n],!1];l(u,{service:i.service,scenario:i.scenario,segment:i.segment});r&&l(u,r);Log.Log.apply(null,u)}function l(n,t){var r,i;for(r in t)n.push(r),i=t[r],typeof i=="boolean"&&(i=i?1:0),n.push(i)}function f(){var r=_d.querySelectorAll(v),u,t,n,e,s,f,i;if(r)for(u="data-initialized",t=0;t<r.length;t++)if(n=r[t],n){if(n.getAttribute(u)==="1")continue;n.setAttribute(u,"1");e=sj_wf(o,n);sj_be(n,"click",e);typeof AccessibilityHelpers!="undefined"&&(s=sj_wf(o,n,!0),AccessibilityHelpers.activateButtonByKey(n,[13,32],s));f=sj_wf(p,n);sj_be(n,"mouseover",function(){i=sb_st(f,200)});sj_be(n,"mouseout",function(){i&&(sb_ct(i),i=0)});sj_be(n,"mousedown",f)}}var t;(function(n){n[n.FetchCard=0]="FetchCard";n[n.ShareButtonClick=1]="ShareButtonClick"})(t||(t={}));var a=/^https?:\/\/|^\/\//i,v="[data-type='shareCardAction']",e="data-sharecardid",y="data-promoted",u={},i=encodeURIComponent;sj_be(_w,"load",function(){return f()});sj_evt.bind("ajax.load",function(){return f()});sj_evt.bind("AjaxFinished",function(){return f()})})(ShareCardAction||(ShareCardAction={}))